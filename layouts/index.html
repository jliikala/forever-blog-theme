{{ define "main" }}
<div class="posts h-feed">
  <div class="post-list" role="main">
      {{ $paginator := .Paginate (where .Site.Pages.ByDate.Reverse "Type" "post") }}
      {{ range .Paginator.Pages }}
			{{ $slug := .File.BaseFileName }}
  		{{ $cover := index .Site.Data.covers $slug }}
      <div class="post-preview h-entry {{ range .Params.categories }} {{ . | urlize | lower }}{{ end }}">
				{{ if $cover }}
					<img class="post-cover" src="{{ $cover.image }}" alt="Post cover for {{ if .Title }}{{ .Title }}{{ else }}{{ .Date.Format "January 2, 2006" }}{{ end }}">
				{{ end }}
				<header class="post-header">
					<a href="{{ .Permalink }}" class="post-date u-url">
						<time class="dt-published" datetime="{{ .Date.Format "2006-01-02 15:04:05 -0700" }}">{{ .Date.Format "January 2, 2006" }}</time>
					</a>
					{{ if .Title }}
					<h2 class="post-title p-name"><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
					{{ end }}
				</header>
				{{ if in .RawContent "<!--more-->" }}
					<div class="p-summary">
						{{ $splitContents := split .RawContent "<!--more-->" }}
						{{ $summary := index $splitContents 0 }}
						{{ $summary := replaceRE "\\[\\^.*?\\]" "" $summary }}
						{{ $summary := replaceRE "\\n\\[\\^.*?\\]:.*" "" $summary }}
						<p>{{ $summary | markdownify }}</p>
						<p>
							<a class="read-more" href="{{ .Permalink }}">
								Continue reading â†’
							</a>
						</p>
					</div>
				{{ else }}
					<div class="e-content with-title">
							{{ .Content }}
					</div>
				{{ end }}
		</div>
		{{ end }}
  </div>
</div>
{{ end }}